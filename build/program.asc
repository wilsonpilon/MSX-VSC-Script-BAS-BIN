1 '{main}
2 CLEAR1000,&HC000:DIMZY$(11):GOSUB5:GOTO9:GOTO3
3 '{encerra}
4 SCREEN0:PRINT"MSX BASIC":END
5 '{inicia}
6 CLS:KEYOFF:SCREEN0:COLOR15,1,1:WIDTH40
7 'on error goto {erro}
8 ONSTOPGOSUB3:STOPON:RETURN
9 '{apresentacao}
10 '{menu}
11 CLS:DEFFNVR(COL,LIN)=COL+LIN*40:BLOAD"menu.alf",S,-&HA00:ZS=12:ZL=1:ZQ=1:ZK=&HD500:ZJ=&HD501:ZI=&HD502:ZH=&HD503:ZG=&HD504:GOSUB12:GOSUB17:GOSUB22:GOSUB30:ZT=1:ZR=0:GOSUB33:GOTO3:GOTO10
12 '{dimensiona}
13 RESTORE58:ZN=0
14 '{lopdim}
15 READZX$:IFZX$<>"@"THENZN=ZN+1:GOTO14
16 DIMZP$(ZN):DIMZO$(ZN):RETURN
17 '{carregamenu}
18 RESTORE58:FORZX=1TOZN:READZP$(ZX):ZP$(ZX)=LEFT$(ZP$(ZX)+SPACE$(16),16):NEXT:RESTORE60:FORZX=1TOZN:READZO$(ZX):ZO$(ZX)=ZO$(ZX)+".bas":NEXT:RETURN
19 '{caracteres}
20 LOCATE1,0:FORF=0TO15:PRINTHEX$(F);:NEXTF:LOCATE0,1:FORF=0TO15:PRINTHEX$(F):NEXTF:FORG=0TO15:FORF=0TO15:VPOKEF+1+(G+1)*40,F+G*16:NEXTF:NEXTG:ZZ$=INPUT$(1):IFZZ$="q"ORZZ$="Q"THENENDELSEIFZZ$="g"ORZZ$="G"THENRUN"graphos.bas"ELSECLEAR:GOTO10
21 RETURN
22 '{desktop}
23 POKEZK,0:POKEZJ,0:POKEZI,40:POKEZH,24:POKEZG,&H80:ZX=USR(0):POKEZK,0:POKEZJ,0:POKEZI,40:POKEZH,1:POKEZG,&H9E:ZX=USR(0):POKEZK,0:POKEZJ,23:ZX=USR(0)
24 ZX$=CHR$(&H9F)+" "+CHR$(&H8B)+CHR$(&H8C)+CHR$(&H8D)+CHR$(&H8E)+" Jogos em Assembler "+CHR$(&H9F):POKEZK,2:POKEZJ,0:ZX$=USR1(ZX$):GOSUB56:ZF=2:ZE=2:ZD=20:ZC=14:GOSUB27:GOSUB56:ZF=23:ZE=2:ZD=15:ZC=7:GOSUB27
25 POKEZK,25:POKEZJ,3:ZX$=CHR$(&HA9)+" - Info":ZX$=USR1(ZX$):POKEZK,25:POKEZJ,4:ZX$=CHR$(&HAA)+" - ":ZX$=USR1(ZX$):POKEZK,25:POKEZJ,5:ZX$=CHR$(&HAB)+" - ":ZX$=USR1(ZX$)
26 POKEZK,25:POKEZJ,6:ZX$=CHR$(&HAC)+" - ":ZX$=USR1(ZX$):POKEZK,25:POKEZJ,7:ZX$=CHR$(&HAD)+" - ":ZX$=USR1(ZX$):RETURN
27 '{janela}
28 POKEZK,ZF+1:POKEZJ,ZE:POKEZI,ZD-2:POKEZH,1:POKEZG,YX:ZX=USR(0):VPOKEZF+ZE*40,YW:VPOKEZF+ZD-1+ZE*40,YY:POKEZK,ZF+1:POKEZJ,ZE+1:POKEZI,ZD-2:POKEZH,ZC-2:POKEZG,ZB:ZX=USR(0)
29 FORZV=ZE+1TOZE+ZC-2:VPOKEZF+ZV*40,YQ:VPOKEZF+ZD-1+ZV*40,YP:NEXT:VPOKEZF+(ZE+ZC-1)*40,YS:POKEZK,ZF+1:POKEZJ,ZE+ZC-1:POKEZI,ZD-2:POKEZH,1:POKEZG,YT:ZX=USR(0):VPOKEZF+ZD-1+(ZE+ZC-1)*40,YU:RETURN
30 '{mostra}
31 FORZX%=ZLTOZL+ZS-1:POKEZK,4:POKEZJ,3+ZX%-ZL:ZX$=USR1(ZP$(ZX%))
32 NEXT:RETURN
33 '{seleciona}
34 GOSUB47:ZZ$=INKEY$:IFZZ$<>""THEN34
35 ZZ$=INKEY$:IFZZ$=""THEN35
36 GOSUB49
37 IFASC(ZZ$)=31THENZT=ZT+1:ZQ=ZQ+1:IFZQ>ZNTHENZQ=ZN
38 IFZT>ZSTHENZT=ZS:ZL=ZQ-ZS+1:GOSUB30
39 IFASC(ZZ$)=30THENZT=ZT-1:ZQ=ZQ-1
40 IFZQ<1THENZQ=1
41 IFZT<1THENZT=1:ZL=ZQ:GOSUB30
42 IFASC(ZZ$)=13THEN51
43 IFASC(ZZ$)=27THEN3
44 IFASC(ZZ$)=11THENCLS:GOTO19
45 IFASC(ZZ$)=24THENGOSUB63
46 GOTO33
47 '{mostra_selecao}
48 POKEZK,4:POKEZJ,2+ZT:ZX$=USR2(ZP$(ZQ)):RETURN
49 '{desmarca}
50 POKEZK,4:POKEZJ,2+ZT:ZX$=USR1(ZP$(ZQ)):RETURN
51 '{executa_bas}
52 IFZQ=0GOTO3
53 RUNZO$(ZQ)
54 '{janelaEspecial}
55 ZB=&H00:ZA=&H00:YZ=&HA0:YW=&H98:YX=&H97:YY=&H81:YV=&HA1:YU=&H85:YT=&H84:YS=&H83:YR=&HA4:YQ=&H82:YP=&H9C:YO=&HA3:YN=&HA2:YM=&H15:RETURN
56 '{janelaComum}
57 ZB=&H00:ZA=&H00:YZ=&HA0:YW=&H18:YX=&H17:YY=&H19:YV=&H12:YU=&H1B:YT=&H17:YS=&H1A:YR=&H11:YQ=&H16:YP=&H16:YO=&H13:YN=&H14:YM=&H15:RETURN
58 '{data_opcoes}
59 DATAFinaliza, Ataque, Base, Combate, Galerias, Gypsie ,Formula 1, Xeros, Asteroids, Panico, Salvamento, Tanques, S.O.S., Cavernas, Missao, Slalom, Labirinto, Futebol, Minas, @
60 '{data_executa}
61 DATAfinaliza, ataque, base, combate, galerias, gypsie ,formula1, xeros, asteroid, panico, Salvamen, tanques, sos, cavernas, missao, slalom, labirint, futebol, minas, @
62 GOTO9
63 '{intro}
64 FORZX=0TO11:ZY$(ZX)="":NEXTZX
65 ZX=USR(1):GOSUB56:ZF=5:ZE=4:ZD=30:ZC=14:GOSUB27:ONZQGOSUB70,75,87,98,113
66 A$=INKEY$:IFA$=""THEN66
67 ZX=USR(2):RETURN
68 '{textointro}
69 FORZX=0TO11:LOCATEZF+1,ZE+ZX+1:PRINTZY$(ZX):NEXTZX:RETURN
70 '{ifinaliza}
71 ZY$(0)="Encerra o programa e volta"
72 ZY$(1)="para o BASIC"
73 GOSUB68
74 RETURN
75 '{iataque}
76 ZY$(0)="Destrua os tanques com auxi-"
77 ZY$(1)="lio do bombardeiro."
78 ZY$(2)="Inicia com 5 bombas, porem"
79 ZY$(3)="transsporta 1 por vez."
80 ZY$(4)=CHR$(&HA7)+" Decola"
81 ZY$(5)=CHR$(&HA7)+" Lanca Bomba"
82 ZY$(6)="A cada 3 tanques destruidos"
83 ZY$(7)="dos ganha 5 bombas adicio-"
84 ZY$(8)="nais."
85 GOSUB68
86 RETURN
87 '{ibase}
88 ZY$(0)="Controle a capsula espacial"
89 ZY$(1)="atraves dos meteoritos para"
90 ZY$(2)="alunizar."
91 ZY$(4)="No centro temos o numero de"
92 ZY$(5)="pontos a serem obtidos."
93 ZY$(7)="Setas "+CHR$(&HA5)+" e "+CHR$(&HA6)+" manobram o "
94 ZY$(8)="aparelho na horizontal."
95 ZY$(9)="Seta "+CHR$(&HA7)+" faz subir"
96 GOSUB68
97 RETURN
98 '{icombate}
99 ZY$(0)="Controle a capsula espacial"
100 ZY$(1)="Atire em avioes, navios e"
101 ZY$(2)="submarinos. Inicialmente tem"
102 ZY$(3)="90s mas ganha 15s ao destru-"
103 ZY$(4)="ir todos alvos."
104 ZY$(5)="Jogo acaba ao final do tempo"
105 ZY$(6)="ou quando tiro acerta mina."
106 ZY$(7)="   submarino=1 ponto"
107 ZY$(8)="   navio=2 pontos"
108 ZY$(9)="   aviao=3 pontos"
109 ZY$(10)="Setas "+CHR$(&HA5)+" e "+CHR$(&HA6)+" manobram base"
110 ZY$(11)="Seta "+CHR$(&HA7)+" atira"
111 GOSUB68
112 RETURN
113 '{igalerias}
114 ZY$(0)="90 segungos para atravessar"
115 ZY$(1)="10 galerias com o submarino."
116 ZY$(2)="Conseguindo, voce tem mais"
117 ZY$(3)="90 segundos para mais 10"
118 ZY$(4)="galerias mais estreitas."
119 ZY$(6)="  Setas "+CHR$(&HA7)+" e "+CHR$(&HA8)+" manobram sub-"
120 ZY$(7)="  marino"
121 ZY$(9)="O proprio peso faz o sub-"
122 ZY$(10)="marino descer"
123 GOSUB68
124 RETURN
125 '{erro}
126 IFERR=10THENERASEZP:ERASEZP$:DIMZP(ZN),ZP$(ZN):RESUMENEXT
127 PRINT"erro:"ERR:PRINT"linha:"ERL:ERRORERR:CLEAR:GOTO3
